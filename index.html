<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Riemann-Thomann Pers√∂nlichkeitstest</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            min-height: 100vh;
            padding: 10px;
            color: #333;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 1.2em;
            margin-bottom: 8px;
        }

        .restart-icon {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 25px;
            height: 25px;
            cursor: pointer;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .restart-icon:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .settings-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 25px;
            height: 25px;
            cursor: pointer;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .settings-icon:hover {
            opacity: 1;
            transform: rotate(90deg);
        }

        .progress-bar {
            background: rgba(255,255,255,0.3);
            height: 8px;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: white;
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-info {
            margin-top: 8px;
            font-size: 0.8em;
            opacity: 0.9;
        }

        .questions-container {
            padding: 30px 20px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .question {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
            border-left: 4px solid #2c3e50;
        }

        .question-number {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .question-text {
            font-size: 1em;
            margin-bottom: 15px;
            line-height: 1.4;
            color: #333;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .option {
            position: relative;
        }

        .option input[type="radio"] {
            display: none;
        }

        .option label {
            display: block;
            padding: 10px 8px;
            text-align: center;
            background: #e8f0fe;
            border: 2px solid #e8f0fe;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8em;
            font-weight: 500;
            line-height: 1.2;
        }

        .option input[type="radio"]:checked + label {
            background: #3498db;
            color: white;
            border-color: #3498db;
            transform: scale(1.05);
        }

        .navigation {
            padding: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
            background: #f8f9ff;
        }

        .nav-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-complete {
            background: #27ae60;
            color: white;
        }

        .btn-complete:hover:not(:disabled) {
            background: #229954;
            transform: translateY(-2px);
        }

        .btn-force-complete {
            background: #e67e22;
            color: white;
            display: none;
        }

        .btn-force-complete:hover:not(:disabled) {
            background: #d35400;
            transform: translateY(-2px);
        }

        .results {
            display: none;
            padding: 30px 20px;
            text-align: center;
        }

        .results.active {
            display: block;
        }

        .results h2 {
            color: #4facfe;
            margin-bottom: 30px;
            font-size: 1.5em;
        }

        .score-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 10px;
            margin: 30px 0;
        }

        .score-item {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 6px;
            border-radius: 8px;
            text-align: center;
        }

        .score-label {
            font-size: 0.75em;
            opacity: 0.9;
            margin-bottom: 2px;
        }

        .score-value {
            font-size: 1.1em;
            font-weight: bold;
        }

        .visualization-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .visualization-title {
            text-align: center;
            color: #3498db;
            margin-bottom: 20px;
            font-size: 1em;
            font-weight: bold;
        }

        .chart-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 500px;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .riemann-chart {
            width: 100%;
            max-width: 700px;
            height: 500px;
        }

        .axis-line {
            stroke: #e0e0e0;
            stroke-width: 2;
        }

        .grid-line {
            stroke: #f0f0f0;
            stroke-width: 1;
        }

        .axis-label {
            font-family: 'Segoe UI', sans-serif;
            font-size: 14px;
            font-weight: bold;
            fill: #3498db;
            text-anchor: middle;
        }

        .score-point {
            fill: #ff6b35;
            stroke: #fff;
            stroke-width: 1;
        }

        .profile-polygon {
            fill: rgba(255, 107, 53, 0.2);
            stroke: #ff6b35;
            stroke-width: 3;
            stroke-linejoin: round;
        }

        .scale-text {
            font-family: 'Segoe UI', sans-serif;
            font-size: 10px;
            fill: #666;
            text-anchor: middle;
        }

        .dominant-type {
            background: #4facfe;
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .dominant-type h4 {
            margin: 20px 0 10px 0;
            font-size: 1.1em;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            padding-bottom: 5px;
        }

        .dominant-type h4:first-child {
            margin-top: 0;
        }

        .dominant-type p {
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .dominant-type strong {
            color: #ffeb3b;
        }

        .personality-type {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
        }

        .personality-type-header {
            padding: 20px 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .personality-type-header:hover {
            background: rgba(255,255,255,0.1);
        }

        .personality-type-header h3 {
            margin: 0;
            font-size: 1.2em;
        }

        .personality-type-score {
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .personality-type-content {
            padding: 0 25px 25px;
            display: none;
        }

        .personality-type-content.active {
            display: block;
        }

        .personality-type-content h4 {
            margin: 20px 0 10px 0;
            font-size: 1.1em;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            padding-bottom: 5px;
        }

        .personality-type-content h4:first-child {
            margin-top: 0;
        }

        .personality-type-content p {
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .personality-type-content strong {
            color: #ffeb3b;
        }

        .toggle-icon {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .personality-type-header.active .toggle-icon {
            transform: rotate(180deg);
        }

        .question-details {
            background: #f8f9ff;
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
        }

        .details-toggle {
            width: 100%;
            background: #e8f0fe;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            color: #3498db;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .details-toggle:hover {
            background: #d0e7ff;
        }

        .details-content {
            display: none;
            padding: 0 20px 20px;
        }

        .details-content.active {
            display: block;
        }

        .category-section {
            margin-bottom: 25px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .category-title {
            font-weight: bold;
            color: #3498db;
            margin-bottom: 15px;
            font-size: 1.1em;
            padding-bottom: 8px;
            border-bottom: 2px solid #e8f0fe;
        }

        .answer-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .answer-item:last-child {
            border-bottom: none;
        }

        .answer-question {
            flex: 1;
            font-size: 0.9em;
            line-height: 1.3;
            margin-right: 15px;
        }

        .answer-value {
            background: #3498db;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            white-space: nowrap;
        }

        .restart-btn {
            background: #27ae60;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .restart-btn:hover {
            background: #229954;
            transform: translateY(-2px);
        }



        .html-btn {
            background: #9b59b6;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            margin-left: 15px;
            transition: all 0.3s ease;
        }

        .html-btn:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
            color: #3498db;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .settings-group {
            margin-bottom: 25px;
        }

        .settings-group h4 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1em;
        }

        .point-input {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9ff;
            border-radius: 10px;
        }

        .point-input label {
            flex: 1;
            font-size: 0.9em;
        }

        .point-input input {
            width: 70px;
            padding: 5px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
        }



        .max-points {
            text-align: center;
            padding: 15px;
            background: #e8f5e8;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
            color: #28a745;
        }

        .settings-actions {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        .settings-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reset-btn {
            background: #dc3545;
            color: white;
        }



        .carmen-note {
            text-align: center;
            margin-top: 30px;
            padding: 15px;
            color: #666;
            font-style: italic;
            font-size: 0.9em;
            border-top: 1px solid #eee;
        }

        .custom-weights-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 0.85em;
            text-align: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @media (max-width: 480px) {
            .options {
                grid-template-columns: 1fr;
            }
            
            .score-grid {
                grid-template-columns: 1fr;
            }

            .presets {
                flex-direction: column;
            }

            .preset-btn {
                text-align: center;
            }

            .answer-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .answer-value {
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <svg class="restart-icon" onclick="restartTest()" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12,5V1L7,6L12,11V7A6,6 0 0,1 18,13A6,6 0 0,1 12,19A6,6 0 0,1 6,13H4A8,8 0 0,0 12,21A8,8 0 0,0 20,13A8,8 0 0,0 12,5Z" />
            </svg>
            <svg class="settings-icon" onclick="openSettings()" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" />
            </svg>
            <h1>Riemann-Thomann Pers√∂nlichkeitstest</h1>
            <p>Entdecke deine Pers√∂nlichkeitsstruktur</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-info" id="progressInfo">Frage 0 von 48</div>
        </div>

        <!-- Questions Container -->
        <div class="questions-container" id="questionsContainer">
            <!-- Questions will be loaded here -->
        </div>

        <!-- Results -->
        <div class="results" id="results">
            <div id="customWeightsNotice" class="custom-weights-notice" style="display: none;">
                ‚öôÔ∏è Benutzerdefinierte Gewichtung verwendet
            </div>
            <div class="visualization-container">
                <div class="visualization-title">Dein Pers√∂nlichkeitsprofil</div>
                <div class="chart-container">
                    <svg class="riemann-chart" id="riemannChart" viewBox="0 0 500 500">
                        <!-- Grid lines -->
                        <g id="gridLines"></g>
                        
                        <!-- Main axes -->
                        <line x1="250" y1="50" x2="250" y2="450" class="axis-line"/>
                        <line x1="50" y1="250" x2="450" y2="250" class="axis-line"/>
                        
                        <!-- Axis labels -->
                        <text x="250" y="30" class="axis-label">Dauer</text>
                        <text x="250" y="470" class="axis-label">Wechsel</text>
                        <text x="450" y="250" class="axis-label">Distanz</text>
                        <text x="50" y="250" class="axis-label">N√§he</text>
                        
                        <!-- Profile polygon -->
                        <polygon id="profilePolygon" class="profile-polygon" points=""/>
                        
                        <!-- Score points -->
                        <circle id="distanzPoint" class="score-point" r="3"/>
                        <circle id="naehePoint" class="score-point" r="3"/>
                        <circle id="dauerPoint" class="score-point" r="3"/>
                        <circle id="wechselPoint" class="score-point" r="3"/>
                        
                        <!-- Scale markers -->
                        <g id="scaleMarkers"></g>
                    </svg>
                </div>
            </div>
            
            <div class="score-grid">
                <div class="score-item">
                    <div class="score-label">Distanz</div>
                    <div class="score-value" id="scoreDistanz">0</div>
                </div>
                <div class="score-item">
                    <div class="score-label">N√§he</div>
                    <div class="score-value" id="scoreNaehe">0</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Dauer</div>
                    <div class="score-value" id="scoreDauer">0</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Wechsel</div>
                    <div class="score-value" id="scoreWechsel">0</div>
                </div>
            </div>
            
            <div class="personality-types" id="personalityTypes">
                <!-- Personality types will be populated here -->
            </div>

            <div class="question-details">
                <button class="details-toggle" onclick="toggleDetails()">
                    üìã Deine Antworten im Detail anzeigen
                    <span id="toggleIcon">‚ñº</span>
                </button>
                <div class="details-content" id="detailsContent">
                    <!-- Content will be populated here -->
                </div>
            </div>

            <button class="restart-btn" onclick="restartTest()">Test wiederholen</button>
            <button class="html-btn" onclick="generateHTML()">üåê Als HTML senden</button>
        </div>

        <div class="navigation" id="navigation">
            <button class="nav-btn btn-complete" id="completeBtn" onclick="completeTest()">Test abschlie√üen</button>
            <button class="nav-btn btn-force-complete" id="forceCompleteBtn" onclick="forceCompleteTest()">Test trotzdem abschlie√üen</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeSettings()">√ó</button>
            <div class="modal-header">
                <h3>‚öôÔ∏è Bewertungseinstellungen</h3>
            </div>
            
            <div class="settings-group">
                <h4>Punktverteilung anpassen:</h4>
                <div class="point-input">
                    <label>stimmt genau:</label>
                    <input type="number" id="points3" min="0" step="0.01" value="1.00">
                </div>
                <div class="point-input">
                    <label>stimmt eher:</label>
                    <input type="number" id="points2" min="0" step="0.01" value="0.67">
                </div>
                <div class="point-input">
                    <label>stimmt wenig:</label>
                    <input type="number" id="points1" min="0" step="0.01" value="0.33">
                </div>
                <div class="point-input">
                    <label>stimmt nicht:</label>
                    <input type="number" id="points0" min="0" step="0.01" value="0.00">
                </div>
            </div>

            <div class="max-points" id="maxPointsDisplay">
                Maximale Gesamtpunktzahl: 48.0
            </div>

            <div class="settings-actions">
                <button class="settings-btn reset-btn" onclick="resetToDefaults()">Zur√ºcksetzen</button>
            </div>
            
            <div class="carmen-note">
                for Carmen with ‚ù§Ô∏è
            </div>
        </div>
    </div>

    <script>
        const originalQuestions = {
            1: [
                "Unabh√§ngigkeit ist mir sehr wichtig.",
                "Ich mache meine Sache lieber allein, bevor ich jemanden um Rat frage.",
                "Es f√§llt mir leicht, Zusammenh√§nge zu durchschauen.",
                "Ich m√∂chte nicht einer unter vielen sein, sondern aus der Masse herausragen.",
                "Ich m√∂chte es im Leben weit bringen / habe es weit gebracht.",
                "Ich lasse mich h√§ufiger zu spitzen Bemerkungen hinrei√üen.",
                "Es liegt mir, Verantwortung zu tragen.",
                "Ich bin eher ein distanzierter Mensch.",
                "Ich f√ºhle mich schnell ergriffen.",
                "Ich ordne mich nicht gerne unter.",
                "Argumente sind mir wichtiger als Emotionen.",
                "Meiner Argumentation ist so leicht keiner gewachsen."
            ],
            2: [
                "Ich neige dazu, mich ausnutzen zu lassen.",
                "Es f√§llt mir viel leichter, f√ºr meine(n) Partner(in) ein Geschenk zu kaufen, als f√ºr mich selbst.",
                "Um des lieben Friedens Willen gebe ich nach.",
                "Es gibt nichts Schlimmeres im Leben, als einen nahestehenden Menschen zu verlieren.",
                "Ich bin ein friedlicher Mensch.",
                "Bescheidenheit ist eine Zier.",
                "Ich habe immer ein offenes Ohr f√ºr die Sorgen anderer Menschen.",
                "Ich wehre mich nicht, aus Angst, die Zuneigung anderer zu verlieren.",
                "Ich beklage mich h√§ufig √ºber mein Los.",
                "Ich sorge mich sehr f√ºr mein leibliches Wohl, das Wohl meiner Familie.",
                "Die anderen sollen mich auch so verw√∂hnen, wie ich sie.",
                "Dauernd will einer was von mir."
            ],
            3: [
                "Es ist mir wichtig, meiner Sache ganz sicher zu sein.",
                "Ich w√§ge lange ab, bevor ich mich entscheide.",
                "Ich lasse lieber alles beim Alten.",
                "Es ist mir wichtig, die √úbersicht zu haben.",
                "Ich w√ºrde nie unvorbereitet in eine unbekannte Situation hineinspringen.",
                "Gesetze sind dazu da, eingehalten zu werden; ich halte mich auch daran.",
                "Ich bin belastungsf√§hig.",
                "Ich halte mich f√ºr einen eher konservativen Menschen.",
                "Vertrauen ist gut, Kontrolle ist besser.",
                "Ich bin ein zuverl√§ssiger Mensch.",
                "Wie es drinnen aussieht, geht niemanden etwas an.",
                "Ich gehe nicht gerne ein Risiko ein."
            ],
            4: [
                "Von mir gehen kreative Impulse aus.",
                "Ich neige zu Unp√ºnktlichkeit.",
                "Regeln empfinde ich als Begrenzung meiner Freiheit.",
                "Ich kann m√ºhelos eine ganze Gesellschaft unterhalten.",
                "Ich habe Angst, abgelehnt zu werden.",
                "Ich kann schlecht warten.",
                "Ich bin ausgesprochen kontaktfreudig.",
                "Ich m√∂chte von allen geliebt werden.",
                "Ich kann mich schnell f√ºr etwas begeistern.",
                "Der Reiz des Neuen ist schnell vorbei.",
                "Ich bin leider so inkonsequent.",
                "Ich wage nicht, meine Meinung zu sagen, wenn sie von der anderer abweicht."
            ]
        };

        const categoryNames = {
            1: 'Distanz',
            2: 'N√§he', 
            3: 'Dauer',
            4: 'Wechsel'
        };

        const typeDescriptions = {
            'Distanz': {
                'general': 'Der Distanz-Mensch arbeitet gern allein und ist viel weniger abh√§ngig vom Klima um ihn herum. Wenn er zusammenarbeiten muss, braucht er immer Abschnitte, die er allein entwickeln kann. Auf Sitzungen ist er nicht gerne, diese empfindet er als unn√∂tig und langweilig. Dem √§u√üeren Stress verschlie√üt er sich, um sich innerlich wieder frei zu machen.',
                'employee': 'F√ºr Distanz-Menschen ist es ausgesprochen schwierig, in einer abh√§ngigen Position zu sein. Oft ist es ihm nur m√∂glich, wenn er eine ‚ÄûExtraposition" hat. Anweisungen ebenso wie Sitzungen sind ihm l√§stig, hier geht der Dauer-Mitarbeiter schnell in den R√ºckzug. Der Distanz-Mitarbeiter sucht eher die Chefposition. Unzufriedenheit mit seiner F√ºhrungskraft zeigt er entweder sofort und direkt oder er fl√ºchtet in Zynismus, Sarkasmus etc., was dann von Au√üen oft fehlinterpretiert wird. In einem wirklich offenen Klima, wenn er nicht vereinnahmt wird und kritisch-konstruktiv sein darf, ist er gut integriert und auch im Team ein echter Leistungstr√§ger.',
                'leader': 'Wichtig ist ihm ein eigenes B√ºro, in dem er in Ruhe arbeiten kann. Er braucht Zeit, um sich an seine Rolle zu gew√∂hnen, da er als F√ºhrungskraft nun mit Menschen und nicht mehr mit Sachen zu tun hat. Er delegiert ungern. Auftr√§ge erteilt er klar und sachlich, wobei ihm Effizienz das Wichtigste ist. Sitzungen beruft er selten ein, und wenn, gestaltet er auch diese sehr sachlich. Gef√ºhle sind f√ºr ihn Privatsache, die gleiche Haltung verlangt er auch von seinen Mitarbeitern. Von Mitarbeitermotivation h√§lt er wenig, Motivation setzt er voraus. Er kritisiert sachlich, Ausbleiben von Kritik hei√üt Lob. Mit Konflikten seiner Mitarbeiter untereinander will er nichts zu tun haben, auch Teamentwicklung findet er peinlich und unn√ºtz. Kontakte mit seiner Umwelt sind ihm eher l√§stig. Der Distanz-Mensch als F√ºhrungskraft kann sich ‚Äûnach oben" f√ºr seine Mitarbeiter sehr ‚Äûins Zeug legen".',
                'role': 'Kritiker, N√∂rgler, Einzelk√§mpfer'
            },
            'N√§he': {
                'general': 'Dem N√§he-Menschen ist ein gutes, kontaktreiches Arbeitsklima wichtig. Ein freier Stuhl steht immer bereit, Begegnungen auf dem Flur werden gesucht. Teamarbeit ist ihm wichtig. Eigene Interessen, die es aber wenig gibt, werden gern zugunsten von Harmonie aufgegeben. Auf Sitzungen geht der N√§he-Mensch eher situativ als geplant vor. Bei psychischer Belastung kann er weniger leisten, weil er sich blockiert f√ºhlt.',
                'employee': 'Die untergeordnete Abh√§ngigkeitssituation wird als positiv erlebt, der N√§he-Mensch identifiziert sich leicht und gern mit dem Chef. Anweisungen bedeuten f√ºr ihn Wahrnehmung. Kritik gegen√ºber dem Vorgesetzten wird meist nicht ge√§u√üert. Der N√§he-Mitarbeiter kann sein volles Potential nur bei einem guten Klima voll entfalten.',
                'leader': 'F√ºhrung ist f√ºr N√§he-Menschen eher unangenehm. Seine Anweisungen sind oft unklar und durch die Blume. Delegation sucht er zu vermeiden, da er seine Mitarbeiter nicht unn√∂tig belasten m√∂chte. Lieber √ºbernimmt er Aufgaben selbst, die er dann zu Hause erledigt, um bei seinen Lieben zu sein. Sitzungen leitet er mit gro√üer Empathie, es geht ihm mehr um die Beziehung/das Verst√§ndnis als um die Sache. Er motiviert seine Mitarbeiter vorwiegend durch Lob, und hat hierbei mehr deren als das Wohl der Firma im Blick. Kritik auszusprechen und Konflikte austragen fallen der N√§he-F√ºhrungskraft schwer. Er pflegt gern informelle Kontakte mit seinem Umfeld.',
                'role': 'Teamentwickler, Vermittler oder Personalmanager'
            },
            'Dauer': {
                'general': 'Hier ist die Heimat des Zeitmanagements. Termine und Fristen sind st√§ndig im Blick. Der Dauer-Mensch kommt selten zu sp√§t, er kann gut aufr√§umen (und erwartet dies auch von anderen). Er hat eine perfekte Ablage und h√§lt alles m√∂glichst schriftlich fest. Klarheit und Struktur sind ihm wichtig, gegenseitige Kontrolle ist ihm selbstverst√§ndlich. Bei Stress sucht er nach Ursachen, analysiert diese und zieht Konsequenzen.',
                'employee': 'Abh√§ngigkeit innerhalb der Hierarchie ist f√ºr ihn selbstverst√§ndlich, Auftr√§ge und Anweisungen nimmt er gern entgegen, wobei er diese m√∂glichst genau verstehen und ins ‚ÄûGro√üe Ganze" einordnen m√∂chte. Er identifiziert sich total mit dem Unternehmen. Ist der Dauer-Mitarbeiter mit seinem Chef unzufrieden, sammelt er zun√§chst Beweise, pr√ºft diese lange Zeit. Wenn er die Situation nicht mehr aush√§lt, bedient er sich im g√ºnstigen Fall der m√ºndlichen oder schriftlichen Beschwerde an seinen Vorgesetzten oder auch dessen Chef. Was er dabei ausl√∂st, erstaunt ihn, denn er wollte nur geh√∂rt werden. Im ung√ºnstigen Fall demontiert er gezielt seinen Vorgesetzten, dann gilt er als hinterh√§ltig und gef√§hrlich. Wenn er sich verstanden und nicht als Spie√üer und Bremser abgestempelt f√ºhlt, leistet er viel und tr√§gt zur Ruhe bei.',
                'leader': 'In der F√ºhrungsposition erteilt er gern Auftr√§ge und Befehle. Er delegiert gut, sagt aber auch genau, wie es gemacht werden soll. Sitzungen leitet er klar und √ºbersichtlich, hat Termine und Zeit im Auge. Ein schneller Entscheider ist er allerdings nicht, hier sichert er sich gerne ab. Er f√∂rdert seine Mitarbeiter konsequent und hart; dabei achtet er stets auf den Nutzen f√ºr das Gesamte. Konflikte zwischen seinen Mitarbeitern regen ihn auf, hier nimmt er dann allerdings doch die Rolle des Ursachenforschers und Kl√§rers ein. Kontakte mit dem Umfeld sind f√ºr ihn ehrenvoll und mit Prestige verbunden.',
                'role': 'Organisator, Planer, Kontrolleur'
            },
            'Wechsel': {
                'general': 'Wechsel-Menschen ist ein unproblematisches Arbeitsklima mit unkonventionellen Seiten wichtig. So k√∂nnen sie ihre Kreativit√§t und Spontaneit√§t entwickeln. Spontane Entscheidungen werden bevorzugt, Dinge werden sofort und schnell angeschoben, das Durchhalten f√§llt Wechsel-Menschen schwer. Unangenehmes wird charmant delegiert. In der Zeitgestaltung ist es wichtig, den richtigen Zeitpunkt abwarten zu d√ºrfen, an dem dann alles ganz leicht geht.',
                'employee': '√úber Hierarchie sieht er hinweg. Gern mit den F√ºhrungskr√§ften per Du, reagiert er ausgesprochen empfindlich auf Machtanwendung. Auftr√§ge nimmt er nur ungern an, wenn, muss er sie plangerecht f√ºr sich umformulieren. Hat die Firma ein interessantes Image, f√§llt es ihm leicht, sich zu identifizieren. Ansonsten distanziert er sich √∂ffentlich. Ist er mit seiner F√ºhrungskraft unzufrieden, erz√§hlt er es ungefragt jedem, l√§sst dabei Dampf ab. Intrigieren will er nicht. F√ºhlt der Wechsel-Mitarbeiter sich geh√∂rt und gesehen, leistet er sehr viel auch in traditionellen Bereichen.',
                'leader': 'Er steht in dem Dilemma, dass er einerseits erfreut ist, die richtige Position zur Umsetzung seiner vielen Ideen zu haben, ohne gleichzeitig autorit√§rer Befehlshaber sein zu wollen. So delegiert er am liebsten unverbindlich zwischen T√ºr und Angel, Controlling ist ihm fremd. Sitzungen sind ihm zu formal. Die Auswirkungen, die dieses Verhalten auf andere hat (Verwirrung, Misstrauen, Schaden an der Sache) nimmt er wenig wahr.',
                'role': 'Ver√§nderungsmanager, Innovator'
            }
        };

        // Create mixed questions array with category tracking
        let mixedQuestions = [];
        let questionMapping = {};

        // Default point values
        let pointValues = {
            3: 1.00,    // stimmt genau
            2: 0.67,    // stimmt eher
            1: 0.33,    // stimmt wenig
            0: 0.00     // stimmt nicht
        };

        let answers = {};

        // LocalStorage Funktionen
        function saveProgress() {
            const progress = {
                answers: answers,
                questionMapping: questionMapping,
                mixedQuestions: mixedQuestions,
                pointValues: pointValues,
                timestamp: Date.now()
            };
            localStorage.setItem('riemannTestProgress', JSON.stringify(progress));
        }

        function loadProgress() {
            const saved = localStorage.getItem('riemannTestProgress');
            if (saved) {
                try {
                    const progress = JSON.parse(saved);
                    // Pr√ºfe ob der gespeicherte Fortschritt nicht √§lter als 24 Stunden ist
                    if (Date.now() - progress.timestamp < 24 * 60 * 60 * 1000) {
                        answers = progress.answers || {};
                        questionMapping = progress.questionMapping || {};
                        mixedQuestions = progress.mixedQuestions || [];
                        pointValues = progress.pointValues || { 3: 1.00, 2: 0.67, 1: 0.33, 0: 0.00 };
                        return true;
                    } else {
                        // L√∂sche abgelaufenen Fortschritt
                        localStorage.removeItem('riemannTestProgress');
                    }
                } catch (e) {
                    console.error('Fehler beim Laden des Fortschritts:', e);
                    localStorage.removeItem('riemannTestProgress');
                }
            }
            return false;
        }

        function clearProgress() {
            localStorage.removeItem('riemannTestProgress');
        }

        function initializeMixedQuestions() {
            mixedQuestions = [];
            questionMapping = {};
            
            // Create array of all questions with category info
            for (let category = 1; category <= 4; category++) {
                originalQuestions[category].forEach((question, index) => {
                    mixedQuestions.push({
                        text: question,
                        category: category,
                        originalIndex: index
                    });
                });
            }
            
            // Shuffle the questions
            for (let i = mixedQuestions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [mixedQuestions[i], mixedQuestions[j]] = [mixedQuestions[j], mixedQuestions[i]];
            }
            
            // Create mapping for later evaluation
            mixedQuestions.forEach((question, index) => {
                questionMapping[index] = question.category;
            });
        }

        function loadQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            mixedQuestions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                // Pr√ºfe ob eine gespeicherte Antwort existiert
                const savedAnswer = answers[index];
                const checkedValue = savedAnswer ? savedAnswer.value : '';
                
                questionDiv.innerHTML = `
                    <div class="question-number">Frage ${index + 1} von 48</div>
                    <div class="question-text">${question.text}</div>
                    <div class="options">
                        <div class="option">
                            <input type="radio" id="q${index}_3" name="q${index}" value="3" ${checkedValue === '3' ? 'checked' : ''}>
                            <label for="q${index}_3">stimmt genau</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="q${index}_2" name="q${index}" value="2" ${checkedValue === '2' ? 'checked' : ''}>
                            <label for="q${index}_2">stimmt eher</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="q${index}_1" name="q${index}" value="1" ${checkedValue === '1' ? 'checked' : ''}>
                            <label for="q${index}_1">stimmt wenig</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="q${index}_0" name="q${index}" value="0" ${checkedValue === '0' ? 'checked' : ''}>
                            <label for="q${index}_0">stimmt nicht</label>
                        </div>
                    </div>
                `;
                
                container.appendChild(questionDiv);
            });

            // Add event listeners for progress tracking
            document.querySelectorAll('input[type="radio"]').forEach(input => {
                input.addEventListener('change', updateProgress);
            });
        }

        function updateProgress() {
            const totalQuestions = mixedQuestions.length;
            let answeredQuestions = 0;
            
            // Sammle alle Antworten
            for (let i = 0; i < totalQuestions; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (answer) {
                    answeredQuestions++;
                    // Speichere Antwort
                    answers[i] = {
                        value: answer.value,
                        question: mixedQuestions[i].text,
                        category: questionMapping[i]
                    };
                } else {
                    // L√∂sche gespeicherte Antwort wenn keine ausgew√§hlt
                    delete answers[i];
                }
            }
            
            // Speichere Fortschritt
            saveProgress();
            
            const progress = (answeredQuestions / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressInfo').textContent = 
                `Frage ${answeredQuestions} von ${totalQuestions} beantwortet`;
            
            // Enable/disable complete button
            const completeBtn = document.getElementById('completeBtn');
            const forceCompleteBtn = document.getElementById('forceCompleteBtn');
            
            if (answeredQuestions === totalQuestions) {
                completeBtn.disabled = false;
                completeBtn.textContent = 'Test abschlie√üen ‚úì';
                forceCompleteBtn.disabled = true;
                forceCompleteBtn.style.display = 'none';
            } else {
                completeBtn.disabled = true;
                completeBtn.textContent = `Noch ${totalQuestions - answeredQuestions} Fragen offen`;
                
                // Show/hide force complete button based on answered questions
                if (answeredQuestions > 0) {
                    forceCompleteBtn.disabled = false;
                    forceCompleteBtn.style.display = 'block';
                    forceCompleteBtn.textContent = `Test trotzdem abschlie√üen (${answeredQuestions}/${totalQuestions})`;
                } else {
                    forceCompleteBtn.disabled = true;
                    forceCompleteBtn.style.display = 'none';
                }
            }
        }

        function completeTest() {
            // Check if all questions are answered
            const totalQuestions = mixedQuestions.length;
            let answeredQuestions = 0;
            
            for (let i = 0; i < totalQuestions; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (answer) answeredQuestions++;
            }
            
            if (answeredQuestions < totalQuestions) {
                alert(`Bitte beantworte alle Fragen. ${totalQuestions - answeredQuestions} Fragen sind noch offen.`);
                return;
            }
            
            calculateResults();
        }

        function forceCompleteTest() {
            // Check if at least some questions are answered
            const totalQuestions = mixedQuestions.length;
            let answeredQuestions = 0;
            
            for (let i = 0; i < totalQuestions; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (answer) answeredQuestions++;
            }
            
            if (answeredQuestions === 0) {
                alert('Bitte beantworte mindestens eine Frage, bevor du den Test abschlie√üt.');
                return;
            }
            
            if (answeredQuestions < totalQuestions) {
                const confirmMessage = `Du hast nur ${answeredQuestions} von ${totalQuestions} Fragen beantwortet. M√∂chtest du den Test trotzdem abschlie√üen?`;
                if (!confirm(confirmMessage)) {
                    return;
                }
            }
            
            calculateResults();
        }

        function calculateResults() {
            const scores = { 1: 0, 2: 0, 3: 0, 4: 0 };
            answers = {};
            
            for (let i = 0; i < mixedQuestions.length; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (answer) {
                    const category = questionMapping[i];
                    const answerValue = parseInt(answer.value);
                    const points = pointValues[answerValue];
                    
                    scores[category] += points;
                    
                    // Store answer for detail view
                    if (!answers[category]) answers[category] = [];
                    answers[category].push({
                        question: mixedQuestions[i].text,
                        answer: getAnswerText(answerValue),
                        points: points
                    });
                }
            }
            
            showResults(scores);
        }

        function getAnswerText(value) {
            const answerTexts = {
                3: 'stimmt genau',
                2: 'stimmt eher', 
                1: 'stimmt wenig',
                0: 'stimmt nicht'
            };
            return answerTexts[value];
        }

        function showResults(scores) {
            document.getElementById('questionsContainer').style.display = 'none';
            document.getElementById('navigation').style.display = 'none';
            document.getElementById('results').classList.add('active');
            
            // Check if custom weights are used
            const isCustom = !isStandardWeights();
            document.getElementById('customWeightsNotice').style.display = isCustom ? 'block' : 'none';
            
            // Update score displays
            document.getElementById('scoreDistanz').textContent = scores[1].toFixed(1);
            document.getElementById('scoreNaehe').textContent = scores[2].toFixed(1);
            document.getElementById('scoreDauer').textContent = scores[3].toFixed(1);
            document.getElementById('scoreWechsel').textContent = scores[4].toFixed(1);
            
            // Sort types by score (highest first)
            const typeScores = [
                { type: 'Distanz', score: scores[1] },
                { type: 'N√§he', score: scores[2] },
                { type: 'Dauer', score: scores[3] },
                { type: 'Wechsel', score: scores[4] }
            ].sort((a, b) => b.score - a.score);
            
            // Create personality types display
            const personalityTypesContainer = document.getElementById('personalityTypes');
            personalityTypesContainer.innerHTML = '';
            
            typeScores.forEach((typeData, index) => {
                const typeInfo = typeDescriptions[typeData.type];
                const isFirst = index === 0; // First one is dominant
                
                const typeHTML = `
                    <div class="personality-type">
                        <div class="personality-type-header ${isFirst ? 'active' : ''}" onclick="togglePersonalityType(this)">
                            <h3>${typeData.type}${isFirst ? ' (Dominant)' : ''}</h3>
                            <div class="personality-type-score">${typeData.score.toFixed(1)} Punkte</div>
                            <span class="toggle-icon">${isFirst ? '‚ñº' : '‚ñ∂'}</span>
                        </div>
                        <div class="personality-type-content ${isFirst ? 'active' : ''}">
                            <h4>Allgemeine Beschreibung:</h4>
                            <p>${typeInfo.general}</p>
                            
                            <h4>Als Mitarbeiter:</h4>
                            <p>${typeInfo.employee}</p>
                            
                            <h4>Als F√ºhrungskraft:</h4>
                            <p>${typeInfo.leader}</p>
                            
                            <h4>Typische Rollen:</h4>
                            <p><strong>${typeInfo.role}</strong></p>
                        </div>
                    </div>
                `;
                
                personalityTypesContainer.innerHTML += typeHTML;
            });
            
            // Update visualization
            updateVisualization(scores);
            
            // Create question details
            createQuestionDetails();
            
            // Update progress to 100%
            document.getElementById('progressFill').style.width = '100%';
            document.getElementById('progressInfo').textContent = 'Test abgeschlossen!';
        }

        function createQuestionDetails() {
            const detailsContent = document.getElementById('detailsContent');
            detailsContent.innerHTML = '';
            
            for (let category = 1; category <= 4; category++) {
                const categorySection = document.createElement('div');
                categorySection.className = 'category-section';
                
                const categoryTitle = document.createElement('div');
                categoryTitle.className = 'category-title';
                categoryTitle.textContent = `${categoryNames[category]} (${answers[category] ? answers[category].reduce((sum, a) => sum + a.points, 0).toFixed(1) : '0.0'} Punkte)`;
                categorySection.appendChild(categoryTitle);
                
                if (answers[category]) {
                    answers[category].forEach(answer => {
                        const answerItem = document.createElement('div');
                        answerItem.className = 'answer-item';
                        
                        answerItem.innerHTML = `
                            <div class="answer-question">${answer.question}</div>
                            <div class="answer-value">${answer.answer}</div>
                        `;
                        
                        categorySection.appendChild(answerItem);
                    });
                }
                
                detailsContent.appendChild(categorySection);
            }
        }

        function toggleDetails() {
            const content = document.getElementById('detailsContent');
            const icon = document.getElementById('toggleIcon');
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                icon.textContent = '‚ñº';
            } else {
                content.classList.add('active');
                icon.textContent = '‚ñ≤';
            }
        }

        function restartTest() {
            // Clear saved progress
            clearProgress();
            
            // Reset all radio buttons
            document.querySelectorAll('input[type="radio"]').forEach(input => {
                input.checked = false;
            });
            
            // Reset answers
            answers = {};
            
            // Remix questions
            initializeMixedQuestions();
            loadQuestions();
            
            // Show questions container
            document.getElementById('questionsContainer').style.display = 'block';
            document.getElementById('navigation').style.display = 'flex';
            document.getElementById('results').classList.remove('active');
            
            // Reset progress
            updateProgress();
            
            // Reset details toggle
            document.getElementById('detailsContent').classList.remove('active');
            document.getElementById('toggleIcon').textContent = '‚ñº';
            
            // Scroll to first question
            document.getElementById('questionsContainer').scrollIntoView({ behavior: 'smooth' });
        }

        // Visualization Functions (unchanged from previous version)
        function updateVisualization(scores) {
            const maxPossible = pointValues[3] * 12;
            const centerX = 250;
            const centerY = 250;
            const maxRadius = 150;
            
            const positions = {
                dauer: {
                    x: centerX,
                    y: centerY - (scores[3] / maxPossible) * maxRadius
                },
                distanz: {
                    x: centerX + (scores[1] / maxPossible) * maxRadius,
                    y: centerY
                },
                wechsel: {
                    x: centerX,
                    y: centerY + (scores[4] / maxPossible) * maxRadius
                },
                naehe: {
                    x: centerX - (scores[2] / maxPossible) * maxRadius,
                    y: centerY
                }
            };
            
            document.getElementById('distanzPoint').setAttribute('cx', positions.distanz.x);
            document.getElementById('distanzPoint').setAttribute('cy', positions.distanz.y);
            
            document.getElementById('naehePoint').setAttribute('cx', positions.naehe.x);
            document.getElementById('naehePoint').setAttribute('cy', positions.naehe.y);
            
            document.getElementById('dauerPoint').setAttribute('cx', positions.dauer.x);
            document.getElementById('dauerPoint').setAttribute('cy', positions.dauer.y);
            
            document.getElementById('wechselPoint').setAttribute('cx', positions.wechsel.x);
            document.getElementById('wechselPoint').setAttribute('cy', positions.wechsel.y);
            
            const polygonPoints = [
                `${positions.dauer.x},${positions.dauer.y}`,
                `${positions.distanz.x},${positions.distanz.y}`,
                `${positions.wechsel.x},${positions.wechsel.y}`,
                `${positions.naehe.x},${positions.naehe.y}`
            ].join(' ');
            
            document.getElementById('profilePolygon').setAttribute('points', polygonPoints);
            
            updateGridAndScale(maxPossible, maxRadius, centerX, centerY);
        }
        
        function updateGridAndScale(maxPossible, maxRadius, centerX, centerY) {
            const gridContainer = document.getElementById('gridLines');
            const scaleContainer = document.getElementById('scaleMarkers');
            
            gridContainer.innerHTML = '';
            scaleContainer.innerHTML = '';
            
            const steps = 4;
            for (let i = 1; i <= steps; i++) {
                const radius = (maxRadius / steps) * i;
                const value = (maxPossible / steps) * i;
                
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', centerX);
                circle.setAttribute('cy', centerY);
                circle.setAttribute('r', radius);
                circle.setAttribute('class', 'grid-line');
                circle.setAttribute('fill', 'none');
                gridContainer.appendChild(circle);
                
                // Skalenmarkierungen f√ºr alle vier Achsen
                // Dauer (oben)
                const scaleTextDauer = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                scaleTextDauer.setAttribute('x', centerX + 8);
                scaleTextDauer.setAttribute('y', centerY - radius + 3);
                scaleTextDauer.setAttribute('class', 'scale-text');
                scaleTextDauer.textContent = Math.round(value);
                scaleContainer.appendChild(scaleTextDauer);
                
                // Wechsel (unten)
                const scaleTextWechsel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                scaleTextWechsel.setAttribute('x', centerX + 8);
                scaleTextWechsel.setAttribute('y', centerY + radius + 3);
                scaleTextWechsel.setAttribute('class', 'scale-text');
                scaleTextWechsel.textContent = Math.round(value);
                scaleContainer.appendChild(scaleTextWechsel);
                
                // Distanz (rechts)
                const scaleTextDistanz = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                scaleTextDistanz.setAttribute('x', centerX + radius + 8);
                scaleTextDistanz.setAttribute('y', centerY + 3);
                scaleTextDistanz.setAttribute('class', 'scale-text');
                scaleTextDistanz.textContent = Math.round(value);
                scaleContainer.appendChild(scaleTextDistanz);
                
                // N√§he (links)
                const scaleTextNaehe = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                scaleTextNaehe.setAttribute('x', centerX - radius - 8);
                scaleTextNaehe.setAttribute('y', centerY + 3);
                scaleTextNaehe.setAttribute('class', 'scale-text');
                scaleTextNaehe.textContent = Math.round(value);
                scaleContainer.appendChild(scaleTextNaehe);
            }
            
            // Zentrumspunkt
            const centerPoint = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            centerPoint.setAttribute('cx', centerX);
            centerPoint.setAttribute('cy', centerY);
            centerPoint.setAttribute('r', '3');
            centerPoint.setAttribute('fill', '#666');
            scaleContainer.appendChild(centerPoint);
            

        }

        // Settings Functions (unchanged from previous version)
        function openSettings() {
            document.getElementById('settingsModal').classList.add('active');
            updatePointInputs();
            updateMaxPoints();
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function updatePointInputs() {
            document.getElementById('points3').value = pointValues[3].toFixed(2);
            document.getElementById('points2').value = pointValues[2].toFixed(2);
            document.getElementById('points1').value = pointValues[1].toFixed(2);
            document.getElementById('points0').value = pointValues[0].toFixed(2);
        }

        function updateMaxPoints() {
            const maxPoints = pointValues[3] * 12 * 4;
            document.getElementById('maxPointsDisplay').textContent = 
                `Maximale Gesamtpunktzahl: ${maxPoints.toFixed(1)}`;
        }

        function applyPreset(presetName) {
            switch(presetName) {
                case 'standard':
                    pointValues = { 3: 1.00, 2: 0.67, 1: 0.33, 0: 0.00 };
                    break;
                case 'linear':
                    pointValues = { 3: 3.00, 2: 2.00, 1: 1.00, 0: 0.00 };
                    break;
                case 'weighted':
                    pointValues = { 3: 2.00, 2: 1.00, 1: 0.50, 0: 0.00 };
                    break;
                case 'binary':
                    pointValues = { 3: 1.00, 2: 1.00, 1: 0.00, 0: 0.00 };
                    break;
            }
            updatePointInputs();
            updateMaxPoints();
        }

        function resetToDefaults() {
            applyPreset('standard');
        }

            

        function isStandardWeights() {
            return pointValues[3] === 1.00 && 
                   pointValues[2] === 0.67 && 
                   pointValues[1] === 0.33 && 
                   pointValues[0] === 0.00;
        }

        function togglePersonalityType(headerElement) {
            const contentElement = headerElement.nextElementSibling;
            const iconElement = headerElement.querySelector('.toggle-icon');
            
            if (contentElement.classList.contains('active')) {
                contentElement.classList.remove('active');
                headerElement.classList.remove('active');
                iconElement.textContent = '‚ñ∂';
            } else {
                contentElement.classList.add('active');
                headerElement.classList.add('active');
                iconElement.textContent = '‚ñº';
            }
        }



        async function generateHTML() {
            try {
                // Zeige Ladeindikator
                const htmlBtn = document.querySelector('.html-btn');
                const originalText = htmlBtn.textContent;
                htmlBtn.textContent = 'üîÑ HTML wird erstellt...';
                htmlBtn.disabled = true;

                // Hole die aktuellen Scores
                const scores = {};
                scores[1] = parseFloat(document.getElementById('scoreDistanz').textContent);
                scores[2] = parseFloat(document.getElementById('scoreNaehe').textContent);
                scores[3] = parseFloat(document.getElementById('scoreDauer').textContent);
                scores[4] = parseFloat(document.getElementById('scoreWechsel').textContent);

                // Bestimme dominanten Typ
                const typeScores = [
                    { type: 'Distanz', score: scores[1] },
                    { type: 'N√§he', score: scores[2] },
                    { type: 'Dauer', score: scores[3] },
                    { type: 'Wechsel', score: scores[4] }
                ].sort((a, b) => b.score - a.score);

                // Erstelle das Diagramm als JPG
                const chartContainer = document.querySelector('.chart-container');
                const chartCanvas = await html2canvas(chartContainer, {
                    scale: 1.0,
                    useCORS: true,
                    backgroundColor: '#e8e8e8'
                });
                
                const chartImgData = chartCanvas.toDataURL('image/jpeg', 0.8);

                // Lade das Logo als Base64 JPG
                let logoData = '';
                try {
                    const response = await fetch('logo.png');
                    const blob = await response.blob();
                    const reader = new FileReader();
                    
                    logoData = await new Promise((resolve) => {
                        reader.onload = () => resolve(reader.result);
                        reader.readAsDataURL(blob);
                    });
                } catch (error) {
                    console.warn('Logo konnte nicht geladen werden:', error);
                    // Fallback: Verwende ein einfaches SVG-Logo
                    logoData = 'data:image/svg+xml;base64,' + btoa(`
                        <svg width="60" height="30" xmlns="http://www.w3.org/2000/svg">
                            <rect width="60" height="30" fill="#3498db" rx="5"/>
                            <text x="30" y="20" text-anchor="middle" fill="white" font-family="Arial" font-size="10" font-weight="bold">CM</text>
                        </svg>
                    `);
                }

                // Erstelle eine einzige HTML-Datei mit beiden Seiten
                const combinedHTML = `
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Riemann-Thomann Pers√∂nlichkeitstest</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            color: #333;
        }
        .page {
            max-width: 800px;
            margin: 0 auto 40px auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            page-break-after: always;
        }
        .page:last-child {
            page-break-after: avoid;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #3498db;
        }
        .header h1 {
            color: #3498db;
            font-size: 28px;
            margin-bottom: 10px;
        }
        .header h2 {
            color: #2c3e50;
            font-size: 20px;
            margin: 0;
        }
        .chart-section {
            text-align: center;
            margin-bottom: 40px;
        }
        .chart-container {
            background: #e8e8e8;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        .chart-container img {
            max-width: 100%;
            height: auto;
        }
        .scores-section {
            margin-bottom: 40px;
        }
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        .score-item {
            background: #3498db;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .score-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        .score-value {
            font-size: 24px;
            font-weight: bold;
        }
        .dominant-type {
            background: #e8f5e8;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #27ae60;
        }
        .dominant-type h3 {
            color: #27ae60;
            margin-bottom: 15px;
            font-size: 20px;
        }
        .dominant-type .score-badge {
            background: #27ae60;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 14px;
            float: right;
        }
        .type-section {
            margin-bottom: 40px;
        }
        .type-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #3498db;
            margin-bottom: 25px;
        }
        .type-card.dominant {
            background: #e8f5e8;
            border-left-color: #27ae60;
        }
        .type-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .type-name {
            color: #3498db;
            font-size: 22px;
            font-weight: bold;
        }
        .type-card.dominant .type-name {
            color: #27ae60;
        }
        .type-score {
            background: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: bold;
        }
        .type-card.dominant .type-score {
            background: #27ae60;
        }
        .type-content h4 {
            color: #2c3e50;
            font-size: 16px;
            margin-bottom: 10px;
            margin-top: 20px;
        }
        .type-content p {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 15px;
            color: #333;
        }
        .type-content .role {
            font-weight: bold;
            color: #e67e22;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 12px;
        }
        .page-number {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #666;
        }
        @media print {
            .page {
                page-break-after: always;
                margin-bottom: 0;
            }
            .page:last-child {
                page-break-after: avoid;
            }
        }
    </style>
</head>
<body>
    <!-- Seite 1: Diagramm und Scores -->
    <div class="page">
        <div class="header">
            <h1>Riemann-Thomann Pers√∂nlichkeitstest</h1>
            <h2>Pers√∂nlichkeitsprofil - Seite 1</h2>
        </div>

        <div class="chart-section">
            <h3 style="color: #2c3e50; font-size: 22px; margin-bottom: 20px;">Ihr Pers√∂nlichkeitsprofil:</h3>
            <div class="chart-container">
                <img src="${chartImgData}" alt="Pers√∂nlichkeitsprofil Diagramm" style="width: 400px; height: 400px;">
            </div>
        </div>

        <div class="scores-section">
            <h3 style="color: #2c3e50; font-size: 22px; margin-bottom: 20px;">Ihre Punktzahlen:</h3>
            <div class="scores-grid">
                <div class="score-item">
                    <div class="score-label">Distanz</div>
                    <div class="score-value">${scores[1].toFixed(1)}</div>
                </div>
                <div class="score-item">
                    <div class="score-label">N√§he</div>
                    <div class="score-value">${scores[2].toFixed(1)}</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Dauer</div>
                    <div class="score-value">${scores[3].toFixed(1)}</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Wechsel</div>
                    <div class="score-value">${scores[4].toFixed(1)}</div>
                </div>
            </div>
        </div>

        <div class="dominant-type">
            <h3>Ihr dominanter Typ: ${typeScores[0].type} <span class="score-badge">${typeScores[0].score.toFixed(1)} Punkte</span></h3>
            <p style="font-size: 16px; line-height: 1.6; color: #333;">${typeDescriptions[typeScores[0].type].general}</p>
        </div>

        <div class="page-number">Seite 1 von 2</div>

        <div class="footer">
            <p>Erstellt am: ${new Date().toLocaleDateString('de-DE')}</p>
            <p style="margin-bottom: 15px;">Riemann-Thomann Pers√∂nlichkeitstest - Carmen Michaelis</p>
            <img src="${logoData}" alt="Logo" style="width: 60px; height: auto; margin: 0 auto; display: block;">
        </div>
    </div>

    <!-- Seite 2: Vollst√§ndige Texte aller Typen -->
    <div class="page">
        <div class="header">
            <h1>Riemann-Thomann Pers√∂nlichkeitstest</h1>
            <h2>Detaillierte Pers√∂nlichkeitsbeschreibungen - Seite 2</h2>
        </div>

        ${typeScores.map((typeData, index) => {
            const typeInfo = typeDescriptions[typeData.type];
            const isDominant = index === 0;
            return `
                <div class="type-section">
                    <div class="type-card ${isDominant ? 'dominant' : ''}">
                        <div class="type-header">
                            <div class="type-name">${typeData.type}${isDominant ? ' (Dominant)' : ''}</div>
                            <div class="type-score">${typeData.score.toFixed(1)} Punkte</div>
                        </div>
                        <div class="type-content">
                            <h4>Allgemeine Beschreibung:</h4>
                            <p>${typeInfo.general}</p>
                            
                            <h4>Als Mitarbeiter:</h4>
                            <p>${typeInfo.employee}</p>
                            
                            <h4>Als F√ºhrungskraft:</h4>
                            <p>${typeInfo.leader}</p>
                            
                            <h4>Typische Rollen:</h4>
                            <p class="role">${typeInfo.role}</p>
                        </div>
                    </div>
                </div>
            `;
        }).join('')}

        <div class="page-number">Seite 2 von 2</div>

        <div class="footer">
            <p>Erstellt am: ${new Date().toLocaleDateString('de-DE')}</p>
            <p style="margin-bottom: 15px;">Riemann-Thomann Pers√∂nlichkeitstest - Carmen Michaelis</p>
            <img src="${logoData}" alt="Logo" style="width: 60px; height: auto; margin: 0 auto; display: block;">
        </div>
    </div>
</body>
</html>`;

                // Erstelle Blob-URL f√ºr die kombinierte HTML-Datei
                const combinedBlob = new Blob([combinedHTML], { type: 'text/html' });
                const combinedUrl = URL.createObjectURL(combinedBlob);

                // Zeige Erfolgsmeldung
                htmlBtn.textContent = '‚úÖ HTML erstellt!';
                
                // Versuche direkt den Teilen-Dialog zu √∂ffnen
                if (navigator.share) {
                    // Native Teilen-API verwenden (falls verf√ºgbar)
                    navigator.share({
                        title: 'Riemann-Thomann Pers√∂nlichkeitstest',
                        text: 'Mein Pers√∂nlichkeitsprofil',
                        url: combinedUrl
                    }).catch((error) => {
                        console.log('Teilen fehlgeschlagen:', error);
                        // Fallback: √ñffne in neuem Tab
                        window.open(combinedUrl, '_blank');
                    });
                } else {
                    // Fallback: √ñffne in neuem Tab
                    window.open(combinedUrl, '_blank');
                }
                
                // Reset Button nach kurzer Verz√∂gerung
                setTimeout(() => {
                    htmlBtn.textContent = originalText;
                    htmlBtn.disabled = false;
                    URL.revokeObjectURL(combinedUrl);
                }, 2000);

            } catch (error) {
                console.error('Fehler beim HTML-Erstellen:', error);
                const htmlBtn = document.querySelector('.html-btn');
                htmlBtn.textContent = '‚ùå Fehler beim HTML-Erstellen';
                setTimeout(() => {
                    htmlBtn.textContent = 'üåê Als HTML senden';
                    htmlBtn.disabled = false;
                }, 3000);
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Versuche gespeicherten Fortschritt zu laden
            const hasProgress = loadProgress();
            
            if (!hasProgress) {
                // Kein gespeicherter Fortschritt, starte neu
            initializeMixedQuestions();
            }
            
            loadQuestions();
            updateProgress();
            
            // Add event listeners for real-time updates in settings
            ['points3', 'points2', 'points1', 'points0'].forEach(id => {
                document.addEventListener('input', function(e) {
                    if (e.target.id === id) {
                        updateMaxPoints();
                    }
                });
            });
        });

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('settingsModal');
            if (e.target === modal) {
                closeSettings();
            }
        });
    </script>
</body>
</html>